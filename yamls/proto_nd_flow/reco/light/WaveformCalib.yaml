classname: WaveformCalib
path: proto_nd_flow.reco.light.wvfm_calib
requires:
  - 'light/events'
  - 'light/deconv'
  - 'light/deconv/alignment'
params:
  # input
  wvfm_dset_name: 'light/deconv'

  # output
  cwvfm_dset_name: 'light/cwvfm'

  # configuration parameters
  gain:
    # by default, don't include channel in waveform sum
    default: 0.0000e+00
      
    # Old JINR gain calibration using LEDs. Units are PE/tick / ADC 
    #1 : {2 : 0.00017191110133127956, 3 : 0.0001761754425527117, 4 : 0.00018319849923789422, 5 : 0.00018440930012982414, 6 : 0.00018187638226050518, 7 : 0.00017276647501105705, 9 : 0.001842353496499937, 10 : 0.0018985419198055892, 11 : 0.0018419191323824117, 12 : 0.001834566161794059, 13 : 0.001914124709053443, 14 : 0.001795977011494253, 18 : 0.00017462002682163612, 19 : 0.0001813276082163166, 20 : 0.00016716593559430834, 21 : 0.00017007728311744857, 22 : 0.00017198679141441938, 23 : 0.00017083971134922372, 25 : 0.001758383974791807, 26 : 0.0017589778228076101, 27 : 0.0019614612101431085, 28 : 0.0019373837569745813, 29 : 0.0019247351564424735, 30 : 0.0019015455762443718, 35 : 0.00016686245194361384, 36 : 0.00018683486787038144, 37 : 0.00017798154687322017, 38 : 0.00017481539494294026, 39 : 0.00017871440009150177, 41 : 0.001475866628884481, 42 : 0.001472112345034858, 43 : 0.0014424852289512554, 44 : 0.0014772619835492105, 45 : 0.0014643861293345832, 46 : 0.001474473907709729, 50 : 0.0001645602948924845, 51 : 0.0001634585207657746, 52 : 0.00016537891617273497, 53 : 0.0001580517941068177, 54 : 0.00016186677716771987, 55 : 0.00016686245194361384, 57 : 0.0016541393182299387, 58 : 0.0016643587558585428, 59 : 0.0016650682011935208, 60 : 0.0016837284482758622, 61 : 0.001694134229643283, 62 : 0.0017037400501581073, }
    #0 : {2 : 0.00018023993540200716, 3 : 0.00018247109657830202, 4 : 0.00017972164711295148, 5 : 0.00017703376387944708, 6 : 0.000179843728423475, 9 : 0.001560939060939061, 10 : 0.00163749738004192, 11 : 0.0017230921923246578, 12 : 0.0016700513039760582, 14 : 0.0016154880066170387, 18 : 0.0002223249857712009, 19 : 0.00023735379006531977, 20 : 0.00020202999741401602, 21 : 0.00019499563209784103, 22 : 0.00023994164619164617, 23 : 0.0002326533650982728, 25 : 0.0015733561574866578, 26 : 0.001648685291700903, 27 : 0.001609331548482024, 28 : 0.0016489024905023215, 29 : 0.001644390654599032, 30 : 0.00160717959267644, 41 : 0.0016116554925219185, 42 : 0.0016318537859007834, 43 : 0.0016325357851844113, 44 : 0.0016645360605092147, 45 : 0.001563125250100401, 46 : 0.0016629416773094932, 50 : 0.0002136021872863978, 51 : 0.00020618896806545261, 52 : 0.00019383451184716536, 53 : 0.00020265888456549936, 54 : 0.00019937476075028708, 55 : 0.00019347449232293213, 57 : 0.0019894321364909598, 58 : 0.0020268517317421197, 59 : 0.0016837284482758622, 60 : 0.001601250256200412, 61 : 0.0016291314774267544, 62 : 0.0019446172993154947, }

    #2x2 Summer24 run PRELIMINARY
    0 : {4 : 0.00625, 5 : 0.00625, 6 : 0.00625, 7 : 0.00625, 8 : 0.00625, 9 : 0.00625, 10 : 0.00625, 11 : 0.00625, 12 : 0.00625, 13 : 0.00625, 14 : 0.00625, 15 : 0.00625, 
        20 : 0.00625, 21 : 0.00625, 22 : 0.00625, 23 : 0.00625, 24 : 0.00625, 25 : 0.00625, 26 : 0.00625, 27 : 0.00625, 28 : 0.00625, 29 : 0.00625, 30 : 0.00625, 31 : 0.00625, 
        36 : 0.00625, 37 : 0.00625, 38 : 0.00625, 39 : 0.00625, 40 : 0.00625, 41 : 0.00625, 42 : 0.00625, 43 : 0.00625, 44 : 0.00625, 45 : 0.00625, 46 : 0.00625, 47 : 0.00625, 
        52 : 0.00625, 53 : 0.00625, 54 : 0.00625, 55 : 0.00625, 56 : 0.00625, 57 : 0.00625, 58 : 0.00625, 59 : 0.00625, 60 : 0.00625, 61 : 0.00625, 62 : 0.00625, 63 : 0.00625}
    1 : {4 : 0.00625, 5 : 0.00625, 6 : 0.00625, 7 : 0.00625, 8 : 0.00625, 9 : 0.00625, 10 : 0.00625, 11 : 0.00625, 12 : 0.00625, 13 : 0.00625, 14 : 0.00625, 15 : 0.00625, 
        20 : 0.00625, 21 : 0.00625, 22 : 0.00625, 23 : 0.00625, 24 : 0.00625, 25 : 0.00625, 26 : 0.00625, 27 : 0.00625, 28 : 0.00625, 29 : 0.00625, 30 : 0.00625, 31 : 0.00625, 
        36 : 0.00625, 37 : 0.00625, 38 : 0.00625, 39 : 0.00625, 40 : 0.00625, 41 : 0.00625, 42 : 0.00625, 43 : 0.00625, 44 : 0.00625, 45 : 0.00625, 46 : 0.00625, 47 : 0.00625, 
        52 : 0.00625, 53 : 0.00625, 54 : 0.00625, 55 : 0.00625, 56 : 0.00625, 57 : 0.00625, 58 : 0.00625, 59 : 0.00625, 60 : 0.00625, 61 : 0.00625, 62 : 0.00625, 63 : 0.00625}
    2 : {4 : 0.002083, 5 : 0.002083, 6 : 0.002083, 7 : 0.002083, 8 : 0.002083, 9 : 0.002083, 10 : 0.002083, 11 : 0.002083, 12 : 0.002083, 13 : 0.002083, 14 : 0.002083, 15 : 0.002083, 
        20 : 0.002083, 21 : 0.002083, 22 : 0.002083, 23 : 0.002083, 24 : 0.002083, 25 : 0.002083, 26 : 0.002083, 27 : 0.002083, 28 : 0.002083, 29 : 0.002083, 30 : 0.002083, 31 : 0.002083, 
        36 : 0.002083, 37 : 0.002083, 38 : 0.002083, 39 : 0.002083, 40 : 0.002083, 41 : 0.002083, 42 : 0.002083, 43 : 0.002083, 44 : 0.002083, 45 : 0.002083, 46 : 0.002083, 47 : 0.002083, 
        52 : 0.002083, 53 : 0.002083, 54 : 0.002083, 55 : 0.002083, 56 : 0.002083, 57 : 0.002083, 58 : 0.002083, 59 : 0.002083, 60 : 0.002083, 61 : 0.002083, 62 : 0.002083, 63 : 0.002083}
    3 : {4 : 0.002083, 5 : 0.002083, 6 : 0.002083, 7 : 0.002083, 8 : 0.002083, 9 : 0.002083, 10 : 0.002083, 11 : 0.002083, 12 : 0.002083, 13 : 0.002083, 14 : 0.002083, 15 : 0.002083, 
        20 : 0.002083, 21 : 0.002083, 22 : 0.002083, 23 : 0.002083, 24 : 0.002083, 25 : 0.002083, 26 : 0.002083, 27 : 0.002083, 28 : 0.002083, 29 : 0.002083, 30 : 0.002083, 31 : 0.002083, 
        36 : 0.002083, 37 : 0.002083, 38 : 0.002083, 39 : 0.002083, 40 : 0.002083, 41 : 0.002083, 42 : 0.002083, 43 : 0.002083, 44 : 0.002083, 45 : 0.002083, 46 : 0.002083, 47 : 0.002083, 
        52 : 0.002083, 53 : 0.002083, 54 : 0.002083, 55 : 0.002083, 56 : 0.002083, 57 : 0.002083, 58 : 0.002083, 59 : 0.002083, 60 : 0.002083, 61 : 0.002083, 62 : 0.002083, 63 : 0.002083}
    4 : {4 : 0.002083, 5 : 0.002083, 6 : 0.002083, 7 : 0.002083, 8 : 0.002083, 9 : 0.002083, 10 : 0.002083, 11 : 0.002083, 12 : 0.002083, 13 : 0.002083, 14 : 0.002083, 15 : 0.002083, 
        20 : 0.002083, 21 : 0.002083, 22 : 0.002083, 23 : 0.002083, 24 : 0.002083, 25 : 0.002083, 26 : 0.002083, 27 : 0.002083, 28 : 0.002083, 29 : 0.002083, 30 : 0.002083, 31 : 0.002083, 
        36 : 0.002083, 37 : 0.002083, 38 : 0.002083, 39 : 0.002083, 40 : 0.002083, 41 : 0.002083, 42 : 0.002083, 43 : 0.002083, 44 : 0.002083, 45 : 0.002083, 46 : 0.002083, 47 : 0.002083, 
        52 : 0.002083, 53 : 0.002083, 54 : 0.002083, 55 : 0.002083, 56 : 0.002083, 57 : 0.002083, 58 : 0.002083, 59 : 0.002083, 60 : 0.002083, 61 : 0.002083, 62 : 0.002083, 63 : 0.002083}
    5 : {4 : 0.002083, 5 : 0.002083, 6 : 0.002083, 7 : 0.002083, 8 : 0.002083, 9 : 0.002083, 10 : 0.002083, 11 : 0.002083, 12 : 0.002083, 13 : 0.002083, 14 : 0.002083, 15 : 0.002083, 
        20 : 0.002083, 21 : 0.002083, 22 : 0.002083, 23 : 0.002083, 24 : 0.002083, 25 : 0.002083, 26 : 0.002083, 27 : 0.002083, 28 : 0.002083, 29 : 0.002083, 30 : 0.002083, 31 : 0.002083, 
        36 : 0.002083, 37 : 0.002083, 38 : 0.002083, 39 : 0.002083, 40 : 0.002083, 41 : 0.002083, 42 : 0.002083, 43 : 0.002083, 44 : 0.002083, 45 : 0.002083, 46 : 0.002083, 47 : 0.002083, 
        52 : 0.002083, 53 : 0.002083, 54 : 0.002083, 55 : 0.002083, 56 : 0.002083, 57 : 0.002083, 58 : 0.002083, 59 : 0.002083, 60 : 0.002083, 61 : 0.002083, 62 : 0.002083, 63 : 0.002083}
    6 : {4 : 0.002083, 5 : 0.002083, 6 : 0.002083, 7 : 0.002083, 8 : 0.002083, 9 : 0.002083, 10 : 0.002083, 11 : 0.002083, 12 : 0.002083, 13 : 0.002083, 14 : 0.002083, 15 : 0.002083, 
        20 : 0.002083, 21 : 0.002083, 22 : 0.002083, 23 : 0.002083, 24 : 0.002083, 25 : 0.002083, 26 : 0.002083, 27 : 0.002083, 28 : 0.002083, 29 : 0.002083, 30 : 0.002083, 31 : 0.002083, 
        36 : 0.002083, 37 : 0.002083, 38 : 0.002083, 39 : 0.002083, 40 : 0.002083, 41 : 0.002083, 42 : 0.002083, 43 : 0.002083, 44 : 0.002083, 45 : 0.002083, 46 : 0.002083, 47 : 0.002083, 
        52 : 0.002083, 53 : 0.002083, 54 : 0.002083, 55 : 0.002083, 56 : 0.002083, 57 : 0.002083, 58 : 0.002083, 59 : 0.002083, 60 : 0.002083, 61 : 0.002083, 62 : 0.002083, 63 : 0.002083}
    7 : {4 : 0.002083, 5 : 0.002083, 6 : 0.002083, 7 : 0.002083, 8 : 0.002083, 9 : 0.002083, 10 : 0.002083, 11 : 0.002083, 12 : 0.002083, 13 : 0.002083, 14 : 0.002083, 15 : 0.002083, 
        20 : 0.002083, 21 : 0.002083, 22 : 0.002083, 23 : 0.002083, 24 : 0.002083, 25 : 0.002083, 26 : 0.002083, 27 : 0.002083, 28 : 0.002083, 29 : 0.002083, 30 : 0.002083, 31 : 0.002083, 
        36 : 0.002083, 37 : 0.002083, 38 : 0.002083, 39 : 0.002083, 40 : 0.002083, 41 : 0.002083, 42 : 0.002083, 43 : 0.002083, 44 : 0.002083, 45 : 0.002083, 46 : 0.002083, 47 : 0.002083, 
        52 : 0.002083, 53 : 0.002083, 54 : 0.002083, 55 : 0.002083, 56 : 0.002083, 57 : 0.002083, 58 : 0.002083, 59 : 0.002083, 60 : 0.002083, 61 : 0.002083, 62 : 0.002083, 63 : 0.002083}

  gain_mc:
    default: 0.0
  
    0: {4 : 0.022857, 5 : 0.022857, 6 : 0.022857, 7 : 0.022857, 8 : 0.022857, 9 : 0.022857, 10 : 0.022857, 11 : 0.022857, 12 : 0.022857, 13 : 0.022857, 14 : 0.022857, 15 : 0.022857,
        20 : 0.022857, 21 : 0.022857, 22 : 0.022857, 23 : 0.022857, 24 : 0.022857, 25 : 0.022857, 26 : 0.022857, 27 : 0.022857, 28 : 0.022857, 29 : 0.022857, 30 : 0.022857, 31 : 0.022857,
        36 : 0.022857, 37 : 0.022857, 38 : 0.022857, 39 : 0.022857, 40 : 0.022857, 41 : 0.022857, 42 : 0.022857, 43 : 0.022857, 44 : 0.022857, 45 : 0.022857, 46 : 0.022857, 47 : 0.022857, 
        52 : 0.022857, 53 : 0.022857, 54 : 0.022857, 55 : 0.022857, 56 : 0.022857, 57 : 0.022857, 58 : 0.022857, 59 : 0.022857, 60 : 0.022857, 61 : 0.022857, 62 : 0.022857, 63 : 0.022857}

    1: {4 : 0.022857, 5 : 0.022857, 6 : 0.022857, 7 : 0.022857, 8 : 0.022857, 9 : 0.022857, 10 : 0.022857, 11 : 0.022857, 12 : 0.022857, 13 : 0.022857, 14 : 0.022857, 15 : 0.022857,
        20 : 0.022857, 21 : 0.022857, 22 : 0.022857, 23 : 0.022857, 24 : 0.022857, 25 : 0.022857, 26 : 0.022857, 27 : 0.022857, 28 : 0.022857, 29 : 0.022857, 30 : 0.022857, 31 : 0.022857,
        36 : 0.022857, 37 : 0.022857, 38 : 0.022857, 39 : 0.022857, 40 : 0.022857, 41 : 0.022857, 42 : 0.022857, 43 : 0.022857, 44 : 0.022857, 45 : 0.022857, 46 : 0.022857, 47 : 0.022857, 
        52 : 0.022857, 53 : 0.022857, 54 : 0.022857, 55 : 0.022857, 56 : 0.022857, 57 : 0.022857, 58 : 0.022857, 59 : 0.022857, 60 : 0.022857, 61 : 0.022857, 62 : 0.022857, 63 : 0.022857}

    2: {4 : 0.022857, 5 : 0.022857, 6 : 0.022857, 7 : 0.022857, 8 : 0.022857, 9 : 0.022857, 10 : 0.022857, 11 : 0.022857, 12 : 0.022857, 13 : 0.022857, 14 : 0.022857, 15 : 0.022857,
        20 : 0.022857, 21 : 0.022857, 22 : 0.022857, 23 : 0.022857, 24 : 0.022857, 25 : 0.022857, 26 : 0.022857, 27 : 0.022857, 28 : 0.022857, 29 : 0.022857, 30 : 0.022857, 31 : 0.022857,
        36 : 0.022857, 37 : 0.022857, 38 : 0.022857, 39 : 0.022857, 40 : 0.022857, 41 : 0.022857, 42 : 0.022857, 43 : 0.022857, 44 : 0.022857, 45 : 0.022857, 46 : 0.022857, 47 : 0.022857, 
        52 : 0.022857, 53 : 0.022857, 54 : 0.022857, 55 : 0.022857, 56 : 0.022857, 57 : 0.022857, 58 : 0.022857, 59 : 0.022857, 60 : 0.022857, 61 : 0.022857, 62 : 0.022857, 63 : 0.022857}

    3: {4 : 0.022857, 5 : 0.022857, 6 : 0.022857, 7 : 0.022857, 8 : 0.022857, 9 : 0.022857, 10 : 0.022857, 11 : 0.022857, 12 : 0.022857, 13 : 0.022857, 14 : 0.022857, 15 : 0.022857,
        20 : 0.022857, 21 : 0.022857, 22 : 0.022857, 23 : 0.022857, 24 : 0.022857, 25 : 0.022857, 26 : 0.022857, 27 : 0.022857, 28 : 0.022857, 29 : 0.022857, 30 : 0.022857, 31 : 0.022857,
        36 : 0.022857, 37 : 0.022857, 38 : 0.022857, 39 : 0.022857, 40 : 0.022857, 41 : 0.022857, 42 : 0.022857, 43 : 0.022857, 44 : 0.022857, 45 : 0.022857, 46 : 0.022857, 47 : 0.022857, 
        52 : 0.022857, 53 : 0.022857, 54 : 0.022857, 55 : 0.022857, 56 : 0.022857, 57 : 0.022857, 58 : 0.022857, 59 : 0.022857, 60 : 0.022857, 61 : 0.022857, 62 : 0.022857, 63 : 0.022857}

    4: {4 : 0.022857, 5 : 0.022857, 6 : 0.022857, 7 : 0.022857, 8 : 0.022857, 9 : 0.022857, 10 : 0.022857, 11 : 0.022857, 12 : 0.022857, 13 : 0.022857, 14 : 0.022857, 15 : 0.022857,
        20 : 0.022857, 21 : 0.022857, 22 : 0.022857, 23 : 0.022857, 24 : 0.022857, 25 : 0.022857, 26 : 0.022857, 27 : 0.022857, 28 : 0.022857, 29 : 0.022857, 30 : 0.022857, 31 : 0.022857,
        36 : 0.022857, 37 : 0.022857, 38 : 0.022857, 39 : 0.022857, 40 : 0.022857, 41 : 0.022857, 42 : 0.022857, 43 : 0.022857, 44 : 0.022857, 45 : 0.022857, 46 : 0.022857, 47 : 0.022857, 
        52 : 0.022857, 53 : 0.022857, 54 : 0.022857, 55 : 0.022857, 56 : 0.022857, 57 : 0.022857, 58 : 0.022857, 59 : 0.022857, 60 : 0.022857, 61 : 0.022857, 62 : 0.022857, 63 : 0.022857}

    5: {4 : 0.022857, 5 : 0.022857, 6 : 0.022857, 7 : 0.022857, 8 : 0.022857, 9 : 0.022857, 10 : 0.022857, 11 : 0.022857, 12 : 0.022857, 13 : 0.022857, 14 : 0.022857, 15 : 0.022857,
        20 : 0.022857, 21 : 0.022857, 22 : 0.022857, 23 : 0.022857, 24 : 0.022857, 25 : 0.022857, 26 : 0.022857, 27 : 0.022857, 28 : 0.022857, 29 : 0.022857, 30 : 0.022857, 31 : 0.022857,
        36 : 0.022857, 37 : 0.022857, 38 : 0.022857, 39 : 0.022857, 40 : 0.022857, 41 : 0.022857, 42 : 0.022857, 43 : 0.022857, 44 : 0.022857, 45 : 0.022857, 46 : 0.022857, 47 : 0.022857, 
        52 : 0.022857, 53 : 0.022857, 54 : 0.022857, 55 : 0.022857, 56 : 0.022857, 57 : 0.022857, 58 : 0.022857, 59 : 0.022857, 60 : 0.022857, 61 : 0.022857, 62 : 0.022857, 63 : 0.022857}

    6: {4 : 0.022857, 5 : 0.022857, 6 : 0.022857, 7 : 0.022857, 8 : 0.022857, 9 : 0.022857, 10 : 0.022857, 11 : 0.022857, 12 : 0.022857, 13 : 0.022857, 14 : 0.022857, 15 : 0.022857,
        20 : 0.022857, 21 : 0.022857, 22 : 0.022857, 23 : 0.022857, 24 : 0.022857, 25 : 0.022857, 26 : 0.022857, 27 : 0.022857, 28 : 0.022857, 29 : 0.022857, 30 : 0.022857, 31 : 0.022857,
        36 : 0.022857, 37 : 0.022857, 38 : 0.022857, 39 : 0.022857, 40 : 0.022857, 41 : 0.022857, 42 : 0.022857, 43 : 0.022857, 44 : 0.022857, 45 : 0.022857, 46 : 0.022857, 47 : 0.022857, 
        52 : 0.022857, 53 : 0.022857, 54 : 0.022857, 55 : 0.022857, 56 : 0.022857, 57 : 0.022857, 58 : 0.022857, 59 : 0.022857, 60 : 0.022857, 61 : 0.022857, 62 : 0.022857, 63 : 0.022857}

    7: {4 : 0.022857, 5 : 0.022857, 6 : 0.022857, 7 : 0.022857, 8 : 0.022857, 9 : 0.022857, 10 : 0.022857, 11 : 0.022857, 12 : 0.022857, 13 : 0.022857, 14 : 0.022857, 15 : 0.022857,
        20 : 0.022857, 21 : 0.022857, 22 : 0.022857, 23 : 0.022857, 24 : 0.022857, 25 : 0.022857, 26 : 0.022857, 27 : 0.022857, 28 : 0.022857, 29 : 0.022857, 30 : 0.022857, 31 : 0.022857,
        36 : 0.022857, 37 : 0.022857, 38 : 0.022857, 39 : 0.022857, 40 : 0.022857, 41 : 0.022857, 42 : 0.022857, 43 : 0.022857, 44 : 0.022857, 45 : 0.022857, 46 : 0.022857, 47 : 0.022857, 
        52 : 0.022857, 53 : 0.022857, 54 : 0.022857, 55 : 0.022857, 56 : 0.022857, 57 : 0.022857, 58 : 0.022857, 59 : 0.022857, 60 : 0.022857, 61 : 0.022857, 62 : 0.022857, 63 : 0.022857}