# Performs delayed signal selection on light signals

flow:
  source: events
  stages: [delayed_analysis]


resources:
 - !include h5flow_yamls/resources/RunData.yaml
 - !include h5flow_yamls/resources/Geometry.yaml


events:
  classname: H5FlowDatasetLoopGenerator
  dset_name: 'charge/events'
  params:
    chunk_size: 32


delayed_analysis:
  classname: DelayedSignal # analysis/delayed_signal.py
  requires:
    - 'charge/hits'
    - name: 'combined/hit_drift'
      path: ['charge/hits', 'combined/hit_drift']
    - name: 'analysis/michel_id/hit_label'
      path: ['charge/hits', 'analysis/michel_id/hit_michel_label']
    - 'analysis/michel_id/michel_label'
    - 'analysis/stopping_muons/event_sel_reco'
    - name: 'light/swvfm'
      path: ['light/events', 'light/swvfm']
    - name: 'light/swvfm/alignment'
      path: ['light/events', 'light/swvfm/alignment']
      
  params:
    noise_factor: 0.333
    noise:
      - [605.2062, 136.5390, 167.1929, 189.0789, 600.7896, 140.3284, 165.0596, 182.7784, 555.9109, 218.7787, 394.6519, 129.7704, 531.8600, 136.5708, 177.3912, 338.6423]
      - [513.9062, 148.8334, 170.2456, 145.7354, 432.4131, 138.3909, 194.3165, 171.2630, 1.000e+9, 137.1913, 173.1882, 148.2387, 435.9421, 179.9740, 228.2152, 157.5978]

